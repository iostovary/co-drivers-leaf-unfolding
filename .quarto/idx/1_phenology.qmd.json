{"title":"Phenology","markdown":{"yaml":{"editor":{"markdown":{"wrap":72}},"editor_options":{"chunk_output_type":"inline"},"execute":{"freeze":false},"format":{"html":{"fig-width":8,"fig-height":4}}},"headingText":"Phenology","containsRefs":false,"markdown":"\n\n\n```{r load-libraries, include=FALSE}\nlocation <- paste0(getwd())\nsource(paste0(\"../00_helpers/setup.R\")) #common libraries and custom functions\nsource(paste0(\"../00_helpers/species_and_phases.R\"))\n```\n\n```{r, include=FALSE, internal = TRUE}\nraw_pheno_meteoswiss <- read.csv2(paste0(path_ext_data, \"meteoswiss/phenodaten_240318/phaeno_previous_240318.csv\"))\nraw_param_meteoswiss <- read.csv2(paste0(path_ext_data, \"meteoswiss/phenodaten_240318/Legende_Parameter_utf_header.csv\"))\nsample_data <- readRDS(paste0(path_own_data, \"/sample_data.rds\"))\nstation_meteoswiss <- readRDS(paste0(path_own_data, \"/station_meteoswiss.rds\"))\n\nraw_contact_meteoswiss <- read.xlsx(paste0(path_ext_data, \"meteoswiss/contacts/Adressen_gesamt_final_Adressabgleich_V04.xlsx\"))\nraw_contract_meteoswiss <- read.xlsx(paste0(path_ext_data, \"meteoswiss/2022_07_05_Beobachterabfolge_anonym.xlsx\"))\n```\n\n## Sites\n\n```{r relief-map}\nlib_maps <- c(\n  \"tmap\", #calculating potential evapotranspiration for water availabilty\n  \"sf\", # spatial data frames\n  \"tmaptools\", # easy conversion and arranging\n  \"terra\",\n  \"cowplot\", # arrange plots\n  \"tidyterra\",\n  \"ggspatial\"\n  )\npackage_fun(lib_maps, \"maps\")\n\nterraOptions(progress=0)\n\nlines_sdf <- st_read(paste0(path_ext_data, \"geodata/swissboundaries3d_2024-01_2056_5728.gdb/swissBOUNDARIES3D_1_5_LV95_LN02.gdb\"), layer = \"TLM_LANDESGEBIET\", quiet=TRUE)\nrelief_raw <- rast(paste0(path_ext_data, \"geodata/SMR1000_relief/SMR1000/SMR1000_2019/SMR1000_EE/SMR1000_RELI.tif\"))\n\ncrs(relief_raw) <- \"EPSG:2056\"\n\nrelief <- crop(relief_raw, lines_sdf) %>% \n  aggregate(fact = 2, fun = mean) %>% # reduce resolution\n  mask(vect(lines_sdf)) # Mask the cropped raster to keep only the area within the boundary\n```\n\n```{r eu-map}\neu_sdf <- st_read(paste0(path_ext_data, \"geodata/ref-countries-2020-20M.shp/CNTR_RG_20M_2020_3035.shp/CNTR_RG_20M_2020_3035.shp\"), quiet=TRUE) %>% \n  filter(EU_STAT == \"T\" | EFTA_STAT == \"T\" | CC_STAT == \"T\" | ISO3_CODE == \"GBR\" | ISO3_CODE == \"RUS\" | ISO3_CODE == \"BLR\") %>%\n  mutate(fill_color = ifelse(ISO3_CODE == \"CHE\", \"red\", \"gray\"))\n\neurope_bbox_latlon <- st_bbox(c(xmin = -10, ymin = 34, xmax = 35, ymax = 72), crs = st_crs(4326))\n\n# Transform the bounding box to match the CRS of the shapefile (ETRS89 / LAEA Europe)\neurope_bbox_projected <- st_transform(st_as_sfc(europe_bbox_latlon), crs = st_crs(eu_sdf))\n\n# Crop the shapefile using the transformed bounding box\neu_sdf_cropped <- eu_sdf %>%\n  st_crop(europe_bbox_projected)\n\neu_map <- \n  tm_shape(eu_sdf_cropped) +\n  tm_polygons(col = \"fill_color\", border.col = \"#424242\", lwd = 0.5) +\n  tm_layout(frame = TRUE)\n```\n\n```{r create-map, include=FALSE}\nsites <- sample_data %>%\n  select(METEO_ID) %>%\n  unique() %>%\n  left_join(station_meteoswiss, by = c(\"METEO_ID\"=\"nat_abbr\"))\nsites_sdf <- st_as_sf(sites %>% select(-stat_LV95_x, -stat_LV95_y, siteId), coords = c(\"stat_WGS_y\", \"stat_WGS_x\"), crs = 4326) %>%\n  st_transform(st_crs(lines_sdf))\n\nbiogeo_sdf <- st_read(paste0(path_ext_data, \"geodata/biogeographical_regions/data_swiss/BiogeographischeRegionen/N2020_Revision_BiogeoRegion.shp\"), quiet=TRUE) %>%\n  st_make_valid() %>% # Fix invalid geometries before any operations\n  group_by(DERegionNa) %>%\n  summarise(geometry = st_union(geometry)) %>% # Merge geometries\n  st_make_valid()\n\nmain_map <- \n  tm_shape(relief) +\n  tm_raster(palette = \"-Greys\",\n            style = \"cont\",\n            breaks = seq(0, 255, by = 5),\n            legend.show = FALSE) +\n  \n  tm_shape(sites_sdf) +\n  tm_bubbles(size = 0.3, col = \"black\", border.col = \"black\", border.alpha = 1, style = \"fixed\") +\n  \n  tm_shape(biogeo_sdf) +\n  tm_polygons( col = \"DERegionNa\",  # Color by 'RegionNum' (replace if needed)\n    palette = \"Set3\",   # A diverse color palette for regions\n    border.col = \"#828282\",  # Add borders to the regions\n    lwd = 0.6,  # Border line width\n    legend.show = FALSE,\n    alpha=0.2) +\n  #tm_text(\"DERegionNa\", size = 0.7, col = \"black\", shadow = TRUE, bg.color=\"white\", bg.alpha = 0.6, clustering = FALSE) +  # Display region names as labels\n\n  tm_layout(frame = FALSE) +\n  tm_compass(position = c(\"right\", \"top\"), size = 2) +\n  tm_scale_bar(position = c(\"left\", \"bottom\"))\n\n# Convert tmap objects to grobs (ggplot-like objects)\nmain_map_grob <- invisible(tmap_grob(main_map))\nmini_map_grob <- invisible(tmap_grob(eu_map))\n```\n\n```{r}\nx <- geodata::elevation_30s(\"Switzerland\", \".\")\nslope <- terrain(x, \"slope\", unit = \"radians\")\naspect <- terrain(x, \"aspect\", unit = \"radians\")\nhill <- shade(slope, aspect, 40, 270)\n\n# Hillshading, but we need a vector of colors\npal_greys <- hcl.colors(1000, \"Grays\")\n\n# Get a vector of colors based on the value of shades\n# Create index\nhill_col <- hill %>%\n  # Rename layer\n  select(shades = 1) %>%\n  mutate(index_col = round(scales::rescale(shades, to = c(1, length(pal_greys))))) %>%\n  pull(index_col) %>%\n  pal_greys[.]\n```\n\n```{r}\nch<-ggplot() +\n  # Add our hill shade and use fill with the vector color\n  geom_spatraster(data = hill, fill = hill_col, maxcell = Inf, alpha = 1) +\n  # And add the initial raster with some alpha\n  geom_spatraster(data = x) +\n  # Add an hypstometric tint\n  scale_fill_hypso_tint_c(\n    palette = \"dem_poster\",\n    # Need alpha to show the hill\n    alpha = 0.5 ) +\n  \n  geom_sf(data = biogeo_sdf, color = \"black\", fill = NA, size = 0.4, alpha = 0.7) +\n  geom_point(data = sites, aes(x = stat_WGS_y, y = stat_WGS_x), \n             color = \"black\", size = 2.5) +\n  \n  ggspatial::annotation_north_arrow(\n    arrow_col=\"#828282\",\n    which_north = TRUE,\n    height=unit(0.1, \"npc\"),\n    width=unit(0.035, \"npc\"),\n    pad_x = unit(0.87, \"npc\"),\n    pad_y = unit(0.8, \"npc\"),\n    style = ggspatial::north_arrow_orienteering(\n      text_col = \"#828282\", \n      fill = c(\"white\", \"#828282\"),\n      line_col = \"#828282\"\n    )) +\n  \n  ggspatial::annotation_scale(\n    bar_cols = c(\"#828282\", \"white\"),\n    line_col=\"#828282\",\n    text_col=\"#828282\",\n    height = unit(0.015, \"npc\"),\n    width_hint = 0.3,\n    pad_x = unit(0.67, \"npc\"),\n    pad_y = unit(0.95, \"npc\"),\n    text_cex = .8)+       # Breaks of 50 km\n  \n  labs(x=\"\", y=\"\") +\n  theme_report(legend.position = \"none\", hjust=0.5)\n```\n\n```{r fig-site-map-tidy, fig.width=8, fig.height=6, fig.cap=\"Locations of 52 sampled SPN sites across biogeographic regions.\"}\ncombined_map <- ggdraw() +\n  draw_plot(ch, 0, 0, 1, 1) +  # main map\n  annotate(\"text\", x = 0.28, y = 0.95, label = \"b\",\n           size = 6, hjust = 0.5, vjust = 0.5, color = \"black\")+\n  draw_plot(mini_map_grob, -0.01, 0.67, 0.32, 0.32) + # mini-map\n  annotate(\"text\", x = 0.24, y = 0.95, label = \"a\",\n           size = 6, hjust = 0.5, vjust = 0.5, color = \"black\")+\n\n  annotate(\"text\", x = 0.645, y = 0.38, label = \"Southern\\nAlps\",\n           size = 3.5, angle = 0, family = \"serif\", color = \"black\", fontface=\"bold\")+\n  \n  annotate(\"text\", x = 0.455, y = 0.34, label = \"Western\\nCentral Alps\", \n           size = 3.5, angle = 0, family = \"serif\", color = \"black\", fontface=\"bold\")+\n  \n  annotate(\"text\", x = 0.805, y = 0.495, label = \"Eastern\\nCentral Alps\", \n           size = 3.5, angle = 0, family = \"serif\", color = \"black\", fontface=\"bold\")+\n  \n  annotate(\"text\", x = 0.470, y = 0.475, label = \"Northern Alps\", \n           size = 3.5, angle = 0, family = \"serif\", color = \"black\", fontface=\"bold\")+\n\n  annotate(\"text\", x = 0.40, y = 0.58, label = \"Central\\nPlateau\", \n           size = 3.5, angle = 0, family = \"serif\", color = \"black\", fontface=\"bold\")+\n  \n  annotate(\"text\", x = 0.365, y = 0.665, label = \"Jura\", \n           size = 3.5, angle = 0, family = \"serif\", color = \"black\", fontface=\"bold\")\n  \ncombined_map\n```\n\n## Data cleaning\n\nContract periods of observers were joined with phenological observations\nusing a non-equi-join to match the absolute day of year of contract\nstart, end and phenological observation. After this only one sampled\nstation (ADB) had one overlap in the relevant time period. The duplicate\nwas resolved manually in favor of the more recent contract.\n\n```{r format-conrtact, internal = TRUE}\ncontract_meteoswiss <- raw_contract_meteoswiss %>% \n  filter(is.na(Enddatum)) %>% \n  dplyr::select(-Stationsname, -Vertrags.ID, -Personen.ID ,-Enddatum) %>% \n  rename(nat_abbr = Stationskuerzel,\n         latest_contract = Startdatum) %>% \n  mutate(STATION_STATUS = \"ACTIVE\")\n\norigin_date <- as.Date(\"1940-01-01\")\n#Enddatum <- as.Date(\"2024-01-01\")\n\n#Note: This could potentially be joined with contract_meteoswiss\nobserver_period <- raw_contract_meteoswiss %>%\n  select(-Stationsname, -Vertrags.ID, -Notizen.zur.Person, -Notizen.zum.Vertrag) %>%\n  rename(nat_abbr = Stationskuerzel) %>%\n  mutate(START_NUMERIC = as.numeric(as.Date(Startdatum)) - as.numeric(origin_date),\n         END_NUMERIC = as.numeric(as.Date(Enddatum)) - as.numeric(origin_date),\n         END_NUMERIC = case_when(is.na(END_NUMERIC) ~ 30681,#\"2024-01-01\"\n                                 TRUE ~END_NUMERIC)) %>%\n  rename(OBSERVER=Personen.ID) %>% \n  select(nat_abbr, OBSERVER, START_NUMERIC, END_NUMERIC)\n\nsaveRDS(observer_period %>% ungroup, paste0(path_own_data, \"/output_data/observer_period.rds\"))\n```\n\n```{r format-phenology, internal = TRUE}\nparam_meteoswiss <- raw_param_meteoswiss %>% \n  select(param_id, scientific.name) %>%\n  separate(scientific.name, c(\"SPECIES\", \"PHASE\"), sep = \" - \", remove = FALSE)\n\nphenology <- raw_pheno_meteoswiss %>% \n  left_join (station_meteoswiss, by = \"nat_abbr\") %>%\n  left_join (param_meteoswiss, by = \"param_id\") %>%\n  mutate(SPECIES_SHORT = case_when(\n        SPECIES == \"Tilia cordata\"~\"TC\",\n        SPECIES == \"Fagus sylvatica\"~\"FS\",\n        SPECIES == \"Larix decidua\"~\"LD\",\n        SPECIES == \"Picea abies\"~\"PA\",\n        #SPECIES == \"Castanea sativa\"~\"CS\",\n        #SPECIES == \"Prunus avium\"~\"PV\",\n        #SPECIES == \"Robinia pseudoacacia\"~\"RP\",\n        #SPECIES == \"Sorbus aucuparia\"~\"SA\",\n        TRUE~(SPECIES)),\n        PHASE = case_when(PHASE %like% \"needle emer\" ~ \"leaf unfolding (50%)\",\n                          PHASE %like% \"needle col\" ~ \"leaf colouring (50%)\",\n                          TRUE ~ PHASE)) %>%\n  unite(SAMPLE_CODE, c(nat_abbr, SPECIES_SHORT), remove = FALSE) %>%\n  mutate(MONTH= as.Date(doy),\n         MONTH= as.integer(substr(MONTH, 6, 7))) %>% \n  mutate(across(c(param_id), as.factor)) %>%\n  rename(year = \"reference_year\") %>% \n  filter(SPECIES_SHORT %in% species_list,\n         PHASE %like% \"unfold\" | PHASE %like% \"colo\") %>%\n  left_join(contract_meteoswiss %>% select(-Notizen.zur.Person, -Notizen.zum.Vertrag), by=\"nat_abbr\") %>% \n  mutate(DATE = as.Date(as.character(value), format=\"%Y%m%d\"),\n         DATE = as.numeric(as.Date(DATE)) - as.numeric(origin_date)) %>%\n  group_by(nat_abbr, SPECIES, PHASE) %>%\n  left_join(observer_period, by = join_by(DATE >= START_NUMERIC, DATE <= END_NUMERIC, nat_abbr==nat_abbr)) %>%\n  select(-START_NUMERIC, - END_NUMERIC, -scientific.name) %>% \n  #remove the one remaining duplicated observer\n  filter(!(OBSERVER == 1024 & year == 2014)) %>%\n  ungroup()\n\nsaveRDS(phenology %>% ungroup(), paste0(path_own_data, \"/input_phenology.rds\"))\n\n#check duplicates after joining observer_period  to pheno_meteoswiss\n#check_duplicate <- pheno_meteoswiss %>% ungroup() %>% group_by(nat_abbr, SPECIES, PHASE, year, doy) %>% filter(n() > 1) %>% ungroup() %>% select(nat_abbr, year) %>% unique()\n\nphenology_cut <- phenology %>%\n              separate(latest_contract, into=c(\"CONTRACT_YEAR\", \"CONTRACT_DAY\", \"CONTRACT_MONTH\"), remove=FALSE) %>% \n              mutate(CONTRACT_YEAR = as.numeric(CONTRACT_YEAR),\n                     CONTRACT_MONTH = as.numeric(CONTRACT_MONTH),\n                     CONTRACT_DAY = as.numeric(CONTRACT_DAY)) %>%\n  left_join(sample_data %>%\n              select(METEO_ID, SPECIES_TREE, START_OF_OBSERVATION_AT_TREE_ASSIGNED),\n            by=c(\"nat_abbr\"=\"METEO_ID\",\"SPECIES_SHORT\"=\"SPECIES_TREE\")) %>% \n  mutate(OBSERVATION_START = case_when(START_OF_OBSERVATION_AT_TREE_ASSIGNED == \"own contract\" ~ CONTRACT_YEAR,\n                                       START_OF_OBSERVATION_AT_TREE_ASSIGNED == \"previous obs\" ~ CONTRACT_YEAR-10,\n                                TRUE ~as.numeric(START_OF_OBSERVATION_AT_TREE_ASSIGNED))) %>%\n  filter(OBSERVATION_START <= year)\n\nsaveRDS(phenology_cut %>% ungroup(), paste0(path_own_data, \"/phenology_observer.rds\"))\n\nphenology_cut <- phenology_cut %>%\n  filter(PHASE %like% phase_list) %>%\n  unite(SAMPLE_CODE, c(nat_abbr, SPECIES_SHORT), remove = FALSE) %>%\n  select(SAMPLE_CODE, nat_abbr, SPECIES_SHORT, year, doy, PHASE)\n```\n\n```{r}\nrange_phenology <- phenology %>%\n  semi_join(phenology_cut, by = c(\"SAMPLE_CODE\", \"nat_abbr\", \"SPECIES_SHORT\", \"year\", \"doy\", \"PHASE\")) %>% \n  select(SAMPLE_CODE, nat_abbr, year, doy, OBSERVER) %>%\n  group_by(SAMPLE_CODE, nat_abbr) %>%\n  summarize(min=min(year), max=max(year), n=n()) %>%\n  ungroup()\n```\n<!-- start:internal -->\n## Legacy of leaf colouration\n\nIncluding a carry over effect of leaf unfolding date when modelling leaf\nsenescense could improve models [@liu2020]. *Therefore, a wide data set\ncontaining the leaf colouration of the previous year has been prepared.*\nThis can be joined with the main data set. When joined with the the main\ndata set, the main data set has the same length before and after the\noperation. Though, great care should be applied during the analysis. At\nthis level the columns from the wide format must be used as explanatory\nvariables only.\n\n```{r wide-colouration}\n#| tbl-cap: \"Subset with leaf unfolding, original leaf colouring and one year lagged leaf colouring\"\n\nphenology_wide <- phenology %>%\n  select(SAMPLE_CODE, PHASE, year, doy) %>%\n  group_by(SAMPLE_CODE, PHASE, year) %>%\n  filter(row_number() == 1) %>% #removing duplicates created by overlaps in observer contracts\n  ungroup() %>%\n  pivot_wider(names_from = PHASE, values_from = doy) %>%\n  clean_names() %>%\n  rename(SAMPLE_CODE=sample_code) %>%\n  group_by(SAMPLE_CODE) %>%\n  mutate(LEAF_COLOURING_LAG = lag(leaf_colouring_50_percent, n = 1)) %>%\n  ungroup() %>%\n  semi_join(phenology_cut, by=c(\"SAMPLE_CODE\",\"year\",\"leaf_unfolding_50_percent\"=\"doy\"))\n\ntable <- phenology_wide %>%\n  select(SAMPLE_CODE, year, leaf_unfolding_50_percent, leaf_colouring_50_percent, LEAF_COLOURING_LAG) %>%\n  arrange(SAMPLE_CODE, year) %>%\n  datatable(rownames=FALSE, options=(list(pageLength=5, scrollX=TRUE)))\ntable\n```\n<!-- start:internal -->\n## Distributions and correlations\n\nDue to the record spring temperatures in 2007 leaf unfolding\nshould have a very early leaf unfolding at most stations.\n\n```{r, include=FALSE}\nphenology_true <- phenology %>% semi_join(phenology_cut, by=c(\"nat_abbr\",\"SPECIES_SHORT\", \"year\", \"doy\"))\n```\n\n```{r fig-onset-distribution, fig.cap=\"Raw distribution of day of year of leaf unfolding at sampled SPN sites. Asterisks represent outliers.\"}\nggplot(data=phenology_true, aes(x=nat_abbr, y=doy, group = nat_abbr))+\n  geom_boxplot(outlier.shape=8, outlier.size=1) +\n  geom_jitter(color=\"#4F4F4F\", size=1, shape = 1, alpha=1, width=0.10)+\n  ylab(\"Day of year\")+\n  xlab(\"Site\")+\n  ylim(70,170)+\n  facet_wrap(~SPECIES, scales='free_y', as.table=FALSE)+\n  theme_report(angle=90)\n```\n\n```{r fig-trend-species-all-unfolding, fig.cap=\"Raw trend of leaf unfolding at sampled SPN stations grouped by species. Curves were fitted with the function 'loess'.\"}\n  ggplot(data=phenology_true,\n  aes(y=doy, x=year, color=SPECIES))+\n  geom_point(alpha=0.2)+\n  geom_line(alpha=0.2)+\n  geom_smooth(method=\"loess\", colour=\"black\")+\n  facet_grid(~SPECIES_SHORT, scales='fixed')+\n  ylim(80,180)+\n  theme_report(legend.position = \"none\",\n               angle=90)\n```\n\n```{r fig-trend-species-single, fig.width = 10, fig.height=4, fig.cap=\"Trend of phenological behavior at sampled SPN stations grouped by species. Each color represents a different SPN station. Data was cleaned for changes in observer. Curves were fitted with the function 'loess'. Plots without loess curves do not have enough data points or vary too much to generate a curve.\"}\nggplot(phenology_true,\n  aes(y=doy, x=year, color=SAMPLE_CODE))+\n  geom_point(alpha=0.2)+\n  geom_line(alpha=0.2)+\n  geom_smooth(method=\"loess\", alpha=0.2, se=FALSE)+\n  facet_wrap(~SPECIES, scales='free', as.table=FALSE)+\n  theme_report(legend.position = \"none\",\n               angle=90)\n```\n<!-- start:internal -->\n```{r, include=FALSE}\nsaveRDS(phenology_cut %>% ungroup(), paste0(path_own_data, \"/input_phenology_cut.rds\"))\nsaveRDS(phenology_wide %>% ungroup(), paste0(path_own_data, \"/input_phenology_wide.rds\"))\n```","srcMarkdownNoYaml":"\n\n# Phenology\n\n```{r load-libraries, include=FALSE}\nlocation <- paste0(getwd())\nsource(paste0(\"../00_helpers/setup.R\")) #common libraries and custom functions\nsource(paste0(\"../00_helpers/species_and_phases.R\"))\n```\n\n```{r, include=FALSE, internal = TRUE}\nraw_pheno_meteoswiss <- read.csv2(paste0(path_ext_data, \"meteoswiss/phenodaten_240318/phaeno_previous_240318.csv\"))\nraw_param_meteoswiss <- read.csv2(paste0(path_ext_data, \"meteoswiss/phenodaten_240318/Legende_Parameter_utf_header.csv\"))\nsample_data <- readRDS(paste0(path_own_data, \"/sample_data.rds\"))\nstation_meteoswiss <- readRDS(paste0(path_own_data, \"/station_meteoswiss.rds\"))\n\nraw_contact_meteoswiss <- read.xlsx(paste0(path_ext_data, \"meteoswiss/contacts/Adressen_gesamt_final_Adressabgleich_V04.xlsx\"))\nraw_contract_meteoswiss <- read.xlsx(paste0(path_ext_data, \"meteoswiss/2022_07_05_Beobachterabfolge_anonym.xlsx\"))\n```\n\n## Sites\n\n```{r relief-map}\nlib_maps <- c(\n  \"tmap\", #calculating potential evapotranspiration for water availabilty\n  \"sf\", # spatial data frames\n  \"tmaptools\", # easy conversion and arranging\n  \"terra\",\n  \"cowplot\", # arrange plots\n  \"tidyterra\",\n  \"ggspatial\"\n  )\npackage_fun(lib_maps, \"maps\")\n\nterraOptions(progress=0)\n\nlines_sdf <- st_read(paste0(path_ext_data, \"geodata/swissboundaries3d_2024-01_2056_5728.gdb/swissBOUNDARIES3D_1_5_LV95_LN02.gdb\"), layer = \"TLM_LANDESGEBIET\", quiet=TRUE)\nrelief_raw <- rast(paste0(path_ext_data, \"geodata/SMR1000_relief/SMR1000/SMR1000_2019/SMR1000_EE/SMR1000_RELI.tif\"))\n\ncrs(relief_raw) <- \"EPSG:2056\"\n\nrelief <- crop(relief_raw, lines_sdf) %>% \n  aggregate(fact = 2, fun = mean) %>% # reduce resolution\n  mask(vect(lines_sdf)) # Mask the cropped raster to keep only the area within the boundary\n```\n\n```{r eu-map}\neu_sdf <- st_read(paste0(path_ext_data, \"geodata/ref-countries-2020-20M.shp/CNTR_RG_20M_2020_3035.shp/CNTR_RG_20M_2020_3035.shp\"), quiet=TRUE) %>% \n  filter(EU_STAT == \"T\" | EFTA_STAT == \"T\" | CC_STAT == \"T\" | ISO3_CODE == \"GBR\" | ISO3_CODE == \"RUS\" | ISO3_CODE == \"BLR\") %>%\n  mutate(fill_color = ifelse(ISO3_CODE == \"CHE\", \"red\", \"gray\"))\n\neurope_bbox_latlon <- st_bbox(c(xmin = -10, ymin = 34, xmax = 35, ymax = 72), crs = st_crs(4326))\n\n# Transform the bounding box to match the CRS of the shapefile (ETRS89 / LAEA Europe)\neurope_bbox_projected <- st_transform(st_as_sfc(europe_bbox_latlon), crs = st_crs(eu_sdf))\n\n# Crop the shapefile using the transformed bounding box\neu_sdf_cropped <- eu_sdf %>%\n  st_crop(europe_bbox_projected)\n\neu_map <- \n  tm_shape(eu_sdf_cropped) +\n  tm_polygons(col = \"fill_color\", border.col = \"#424242\", lwd = 0.5) +\n  tm_layout(frame = TRUE)\n```\n\n```{r create-map, include=FALSE}\nsites <- sample_data %>%\n  select(METEO_ID) %>%\n  unique() %>%\n  left_join(station_meteoswiss, by = c(\"METEO_ID\"=\"nat_abbr\"))\nsites_sdf <- st_as_sf(sites %>% select(-stat_LV95_x, -stat_LV95_y, siteId), coords = c(\"stat_WGS_y\", \"stat_WGS_x\"), crs = 4326) %>%\n  st_transform(st_crs(lines_sdf))\n\nbiogeo_sdf <- st_read(paste0(path_ext_data, \"geodata/biogeographical_regions/data_swiss/BiogeographischeRegionen/N2020_Revision_BiogeoRegion.shp\"), quiet=TRUE) %>%\n  st_make_valid() %>% # Fix invalid geometries before any operations\n  group_by(DERegionNa) %>%\n  summarise(geometry = st_union(geometry)) %>% # Merge geometries\n  st_make_valid()\n\nmain_map <- \n  tm_shape(relief) +\n  tm_raster(palette = \"-Greys\",\n            style = \"cont\",\n            breaks = seq(0, 255, by = 5),\n            legend.show = FALSE) +\n  \n  tm_shape(sites_sdf) +\n  tm_bubbles(size = 0.3, col = \"black\", border.col = \"black\", border.alpha = 1, style = \"fixed\") +\n  \n  tm_shape(biogeo_sdf) +\n  tm_polygons( col = \"DERegionNa\",  # Color by 'RegionNum' (replace if needed)\n    palette = \"Set3\",   # A diverse color palette for regions\n    border.col = \"#828282\",  # Add borders to the regions\n    lwd = 0.6,  # Border line width\n    legend.show = FALSE,\n    alpha=0.2) +\n  #tm_text(\"DERegionNa\", size = 0.7, col = \"black\", shadow = TRUE, bg.color=\"white\", bg.alpha = 0.6, clustering = FALSE) +  # Display region names as labels\n\n  tm_layout(frame = FALSE) +\n  tm_compass(position = c(\"right\", \"top\"), size = 2) +\n  tm_scale_bar(position = c(\"left\", \"bottom\"))\n\n# Convert tmap objects to grobs (ggplot-like objects)\nmain_map_grob <- invisible(tmap_grob(main_map))\nmini_map_grob <- invisible(tmap_grob(eu_map))\n```\n\n```{r}\nx <- geodata::elevation_30s(\"Switzerland\", \".\")\nslope <- terrain(x, \"slope\", unit = \"radians\")\naspect <- terrain(x, \"aspect\", unit = \"radians\")\nhill <- shade(slope, aspect, 40, 270)\n\n# Hillshading, but we need a vector of colors\npal_greys <- hcl.colors(1000, \"Grays\")\n\n# Get a vector of colors based on the value of shades\n# Create index\nhill_col <- hill %>%\n  # Rename layer\n  select(shades = 1) %>%\n  mutate(index_col = round(scales::rescale(shades, to = c(1, length(pal_greys))))) %>%\n  pull(index_col) %>%\n  pal_greys[.]\n```\n\n```{r}\nch<-ggplot() +\n  # Add our hill shade and use fill with the vector color\n  geom_spatraster(data = hill, fill = hill_col, maxcell = Inf, alpha = 1) +\n  # And add the initial raster with some alpha\n  geom_spatraster(data = x) +\n  # Add an hypstometric tint\n  scale_fill_hypso_tint_c(\n    palette = \"dem_poster\",\n    # Need alpha to show the hill\n    alpha = 0.5 ) +\n  \n  geom_sf(data = biogeo_sdf, color = \"black\", fill = NA, size = 0.4, alpha = 0.7) +\n  geom_point(data = sites, aes(x = stat_WGS_y, y = stat_WGS_x), \n             color = \"black\", size = 2.5) +\n  \n  ggspatial::annotation_north_arrow(\n    arrow_col=\"#828282\",\n    which_north = TRUE,\n    height=unit(0.1, \"npc\"),\n    width=unit(0.035, \"npc\"),\n    pad_x = unit(0.87, \"npc\"),\n    pad_y = unit(0.8, \"npc\"),\n    style = ggspatial::north_arrow_orienteering(\n      text_col = \"#828282\", \n      fill = c(\"white\", \"#828282\"),\n      line_col = \"#828282\"\n    )) +\n  \n  ggspatial::annotation_scale(\n    bar_cols = c(\"#828282\", \"white\"),\n    line_col=\"#828282\",\n    text_col=\"#828282\",\n    height = unit(0.015, \"npc\"),\n    width_hint = 0.3,\n    pad_x = unit(0.67, \"npc\"),\n    pad_y = unit(0.95, \"npc\"),\n    text_cex = .8)+       # Breaks of 50 km\n  \n  labs(x=\"\", y=\"\") +\n  theme_report(legend.position = \"none\", hjust=0.5)\n```\n\n```{r fig-site-map-tidy, fig.width=8, fig.height=6, fig.cap=\"Locations of 52 sampled SPN sites across biogeographic regions.\"}\ncombined_map <- ggdraw() +\n  draw_plot(ch, 0, 0, 1, 1) +  # main map\n  annotate(\"text\", x = 0.28, y = 0.95, label = \"b\",\n           size = 6, hjust = 0.5, vjust = 0.5, color = \"black\")+\n  draw_plot(mini_map_grob, -0.01, 0.67, 0.32, 0.32) + # mini-map\n  annotate(\"text\", x = 0.24, y = 0.95, label = \"a\",\n           size = 6, hjust = 0.5, vjust = 0.5, color = \"black\")+\n\n  annotate(\"text\", x = 0.645, y = 0.38, label = \"Southern\\nAlps\",\n           size = 3.5, angle = 0, family = \"serif\", color = \"black\", fontface=\"bold\")+\n  \n  annotate(\"text\", x = 0.455, y = 0.34, label = \"Western\\nCentral Alps\", \n           size = 3.5, angle = 0, family = \"serif\", color = \"black\", fontface=\"bold\")+\n  \n  annotate(\"text\", x = 0.805, y = 0.495, label = \"Eastern\\nCentral Alps\", \n           size = 3.5, angle = 0, family = \"serif\", color = \"black\", fontface=\"bold\")+\n  \n  annotate(\"text\", x = 0.470, y = 0.475, label = \"Northern Alps\", \n           size = 3.5, angle = 0, family = \"serif\", color = \"black\", fontface=\"bold\")+\n\n  annotate(\"text\", x = 0.40, y = 0.58, label = \"Central\\nPlateau\", \n           size = 3.5, angle = 0, family = \"serif\", color = \"black\", fontface=\"bold\")+\n  \n  annotate(\"text\", x = 0.365, y = 0.665, label = \"Jura\", \n           size = 3.5, angle = 0, family = \"serif\", color = \"black\", fontface=\"bold\")\n  \ncombined_map\n```\n\n## Data cleaning\n\nContract periods of observers were joined with phenological observations\nusing a non-equi-join to match the absolute day of year of contract\nstart, end and phenological observation. After this only one sampled\nstation (ADB) had one overlap in the relevant time period. The duplicate\nwas resolved manually in favor of the more recent contract.\n\n```{r format-conrtact, internal = TRUE}\ncontract_meteoswiss <- raw_contract_meteoswiss %>% \n  filter(is.na(Enddatum)) %>% \n  dplyr::select(-Stationsname, -Vertrags.ID, -Personen.ID ,-Enddatum) %>% \n  rename(nat_abbr = Stationskuerzel,\n         latest_contract = Startdatum) %>% \n  mutate(STATION_STATUS = \"ACTIVE\")\n\norigin_date <- as.Date(\"1940-01-01\")\n#Enddatum <- as.Date(\"2024-01-01\")\n\n#Note: This could potentially be joined with contract_meteoswiss\nobserver_period <- raw_contract_meteoswiss %>%\n  select(-Stationsname, -Vertrags.ID, -Notizen.zur.Person, -Notizen.zum.Vertrag) %>%\n  rename(nat_abbr = Stationskuerzel) %>%\n  mutate(START_NUMERIC = as.numeric(as.Date(Startdatum)) - as.numeric(origin_date),\n         END_NUMERIC = as.numeric(as.Date(Enddatum)) - as.numeric(origin_date),\n         END_NUMERIC = case_when(is.na(END_NUMERIC) ~ 30681,#\"2024-01-01\"\n                                 TRUE ~END_NUMERIC)) %>%\n  rename(OBSERVER=Personen.ID) %>% \n  select(nat_abbr, OBSERVER, START_NUMERIC, END_NUMERIC)\n\nsaveRDS(observer_period %>% ungroup, paste0(path_own_data, \"/output_data/observer_period.rds\"))\n```\n\n```{r format-phenology, internal = TRUE}\nparam_meteoswiss <- raw_param_meteoswiss %>% \n  select(param_id, scientific.name) %>%\n  separate(scientific.name, c(\"SPECIES\", \"PHASE\"), sep = \" - \", remove = FALSE)\n\nphenology <- raw_pheno_meteoswiss %>% \n  left_join (station_meteoswiss, by = \"nat_abbr\") %>%\n  left_join (param_meteoswiss, by = \"param_id\") %>%\n  mutate(SPECIES_SHORT = case_when(\n        SPECIES == \"Tilia cordata\"~\"TC\",\n        SPECIES == \"Fagus sylvatica\"~\"FS\",\n        SPECIES == \"Larix decidua\"~\"LD\",\n        SPECIES == \"Picea abies\"~\"PA\",\n        #SPECIES == \"Castanea sativa\"~\"CS\",\n        #SPECIES == \"Prunus avium\"~\"PV\",\n        #SPECIES == \"Robinia pseudoacacia\"~\"RP\",\n        #SPECIES == \"Sorbus aucuparia\"~\"SA\",\n        TRUE~(SPECIES)),\n        PHASE = case_when(PHASE %like% \"needle emer\" ~ \"leaf unfolding (50%)\",\n                          PHASE %like% \"needle col\" ~ \"leaf colouring (50%)\",\n                          TRUE ~ PHASE)) %>%\n  unite(SAMPLE_CODE, c(nat_abbr, SPECIES_SHORT), remove = FALSE) %>%\n  mutate(MONTH= as.Date(doy),\n         MONTH= as.integer(substr(MONTH, 6, 7))) %>% \n  mutate(across(c(param_id), as.factor)) %>%\n  rename(year = \"reference_year\") %>% \n  filter(SPECIES_SHORT %in% species_list,\n         PHASE %like% \"unfold\" | PHASE %like% \"colo\") %>%\n  left_join(contract_meteoswiss %>% select(-Notizen.zur.Person, -Notizen.zum.Vertrag), by=\"nat_abbr\") %>% \n  mutate(DATE = as.Date(as.character(value), format=\"%Y%m%d\"),\n         DATE = as.numeric(as.Date(DATE)) - as.numeric(origin_date)) %>%\n  group_by(nat_abbr, SPECIES, PHASE) %>%\n  left_join(observer_period, by = join_by(DATE >= START_NUMERIC, DATE <= END_NUMERIC, nat_abbr==nat_abbr)) %>%\n  select(-START_NUMERIC, - END_NUMERIC, -scientific.name) %>% \n  #remove the one remaining duplicated observer\n  filter(!(OBSERVER == 1024 & year == 2014)) %>%\n  ungroup()\n\nsaveRDS(phenology %>% ungroup(), paste0(path_own_data, \"/input_phenology.rds\"))\n\n#check duplicates after joining observer_period  to pheno_meteoswiss\n#check_duplicate <- pheno_meteoswiss %>% ungroup() %>% group_by(nat_abbr, SPECIES, PHASE, year, doy) %>% filter(n() > 1) %>% ungroup() %>% select(nat_abbr, year) %>% unique()\n\nphenology_cut <- phenology %>%\n              separate(latest_contract, into=c(\"CONTRACT_YEAR\", \"CONTRACT_DAY\", \"CONTRACT_MONTH\"), remove=FALSE) %>% \n              mutate(CONTRACT_YEAR = as.numeric(CONTRACT_YEAR),\n                     CONTRACT_MONTH = as.numeric(CONTRACT_MONTH),\n                     CONTRACT_DAY = as.numeric(CONTRACT_DAY)) %>%\n  left_join(sample_data %>%\n              select(METEO_ID, SPECIES_TREE, START_OF_OBSERVATION_AT_TREE_ASSIGNED),\n            by=c(\"nat_abbr\"=\"METEO_ID\",\"SPECIES_SHORT\"=\"SPECIES_TREE\")) %>% \n  mutate(OBSERVATION_START = case_when(START_OF_OBSERVATION_AT_TREE_ASSIGNED == \"own contract\" ~ CONTRACT_YEAR,\n                                       START_OF_OBSERVATION_AT_TREE_ASSIGNED == \"previous obs\" ~ CONTRACT_YEAR-10,\n                                TRUE ~as.numeric(START_OF_OBSERVATION_AT_TREE_ASSIGNED))) %>%\n  filter(OBSERVATION_START <= year)\n\nsaveRDS(phenology_cut %>% ungroup(), paste0(path_own_data, \"/phenology_observer.rds\"))\n\nphenology_cut <- phenology_cut %>%\n  filter(PHASE %like% phase_list) %>%\n  unite(SAMPLE_CODE, c(nat_abbr, SPECIES_SHORT), remove = FALSE) %>%\n  select(SAMPLE_CODE, nat_abbr, SPECIES_SHORT, year, doy, PHASE)\n```\n\n```{r}\nrange_phenology <- phenology %>%\n  semi_join(phenology_cut, by = c(\"SAMPLE_CODE\", \"nat_abbr\", \"SPECIES_SHORT\", \"year\", \"doy\", \"PHASE\")) %>% \n  select(SAMPLE_CODE, nat_abbr, year, doy, OBSERVER) %>%\n  group_by(SAMPLE_CODE, nat_abbr) %>%\n  summarize(min=min(year), max=max(year), n=n()) %>%\n  ungroup()\n```\n<!-- start:internal -->\n## Legacy of leaf colouration\n\nIncluding a carry over effect of leaf unfolding date when modelling leaf\nsenescense could improve models [@liu2020]. *Therefore, a wide data set\ncontaining the leaf colouration of the previous year has been prepared.*\nThis can be joined with the main data set. When joined with the the main\ndata set, the main data set has the same length before and after the\noperation. Though, great care should be applied during the analysis. At\nthis level the columns from the wide format must be used as explanatory\nvariables only.\n\n```{r wide-colouration}\n#| tbl-cap: \"Subset with leaf unfolding, original leaf colouring and one year lagged leaf colouring\"\n\nphenology_wide <- phenology %>%\n  select(SAMPLE_CODE, PHASE, year, doy) %>%\n  group_by(SAMPLE_CODE, PHASE, year) %>%\n  filter(row_number() == 1) %>% #removing duplicates created by overlaps in observer contracts\n  ungroup() %>%\n  pivot_wider(names_from = PHASE, values_from = doy) %>%\n  clean_names() %>%\n  rename(SAMPLE_CODE=sample_code) %>%\n  group_by(SAMPLE_CODE) %>%\n  mutate(LEAF_COLOURING_LAG = lag(leaf_colouring_50_percent, n = 1)) %>%\n  ungroup() %>%\n  semi_join(phenology_cut, by=c(\"SAMPLE_CODE\",\"year\",\"leaf_unfolding_50_percent\"=\"doy\"))\n\ntable <- phenology_wide %>%\n  select(SAMPLE_CODE, year, leaf_unfolding_50_percent, leaf_colouring_50_percent, LEAF_COLOURING_LAG) %>%\n  arrange(SAMPLE_CODE, year) %>%\n  datatable(rownames=FALSE, options=(list(pageLength=5, scrollX=TRUE)))\ntable\n```\n<!-- start:internal -->\n## Distributions and correlations\n\nDue to the record spring temperatures in 2007 leaf unfolding\nshould have a very early leaf unfolding at most stations.\n\n```{r, include=FALSE}\nphenology_true <- phenology %>% semi_join(phenology_cut, by=c(\"nat_abbr\",\"SPECIES_SHORT\", \"year\", \"doy\"))\n```\n\n```{r fig-onset-distribution, fig.cap=\"Raw distribution of day of year of leaf unfolding at sampled SPN sites. Asterisks represent outliers.\"}\nggplot(data=phenology_true, aes(x=nat_abbr, y=doy, group = nat_abbr))+\n  geom_boxplot(outlier.shape=8, outlier.size=1) +\n  geom_jitter(color=\"#4F4F4F\", size=1, shape = 1, alpha=1, width=0.10)+\n  ylab(\"Day of year\")+\n  xlab(\"Site\")+\n  ylim(70,170)+\n  facet_wrap(~SPECIES, scales='free_y', as.table=FALSE)+\n  theme_report(angle=90)\n```\n\n```{r fig-trend-species-all-unfolding, fig.cap=\"Raw trend of leaf unfolding at sampled SPN stations grouped by species. Curves were fitted with the function 'loess'.\"}\n  ggplot(data=phenology_true,\n  aes(y=doy, x=year, color=SPECIES))+\n  geom_point(alpha=0.2)+\n  geom_line(alpha=0.2)+\n  geom_smooth(method=\"loess\", colour=\"black\")+\n  facet_grid(~SPECIES_SHORT, scales='fixed')+\n  ylim(80,180)+\n  theme_report(legend.position = \"none\",\n               angle=90)\n```\n\n```{r fig-trend-species-single, fig.width = 10, fig.height=4, fig.cap=\"Trend of phenological behavior at sampled SPN stations grouped by species. Each color represents a different SPN station. Data was cleaned for changes in observer. Curves were fitted with the function 'loess'. Plots without loess curves do not have enough data points or vary too much to generate a curve.\"}\nggplot(phenology_true,\n  aes(y=doy, x=year, color=SAMPLE_CODE))+\n  geom_point(alpha=0.2)+\n  geom_line(alpha=0.2)+\n  geom_smooth(method=\"loess\", alpha=0.2, se=FALSE)+\n  facet_wrap(~SPECIES, scales='free', as.table=FALSE)+\n  theme_report(legend.position = \"none\",\n               angle=90)\n```\n<!-- start:internal -->\n```{r, include=FALSE}\nsaveRDS(phenology_cut %>% ungroup(), paste0(path_own_data, \"/input_phenology_cut.rds\"))\nsaveRDS(phenology_wide %>% ungroup(), paste0(path_own_data, \"/input_phenology_wide.rds\"))\n```"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":8,"fig-height":4,"fig-format":"retina","fig-dpi":96,"df-print":"paged","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"wrap","code-link":false,"code-line-numbers":true,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","highlight-style":"espresso","toc":true,"toc-depth":3,"include-in-header":{"text":"<script type=\"text/javascript\" src=\"C:/Users/iostovary/Documents/Data/00_helpers/zoom.js\"></script>"},"output-file":"1_phenology.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.549","bibliography":["C:/Users/iostovary/Documents/Data/references.bib"],"csl":"C:/Users/iostovary/Documents/Data/citation_style_global-ecology-and-biogeography_mod_ostovary.csl","editor":{"markdown":{"wrap":72}},"page-layout":"full","code-summary":"Show the code","theme":"minty","code-folding":"hide","grid":{"body-width":"1100px"},"toc-location":"right","toc-float":{"collapsed":false,"number-sections":true},"editor_options":{"chunk_output_type":"inline"}},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}